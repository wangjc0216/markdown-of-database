调研分布式数据库是如何做到高性能的
利用3个工作日的时间，调研

当代 高性能 的分布式数据库有哪些，
每种数据库分别利用什么技术实现高性能的
这些实现高性能的技术，技术原理分别是什么
并写成文档，文档的读者为无数据库经验的研发人员，写文档的时候从读者角度思考和编写。

分布式数据库（系统） 是一个系统科学，不仅仅是数据库软件来作用，还有在数据库的基础上做的软件开发，我们主要调研的是数据库

关系型数据库（mysql）  文档型数据库（mongo）  搜索引擎 （lucene）




## 1.不同种类数据库的使用场景
### 1.1关系型数据库
mysql为代表
数据格式  
索引实现方式
acid
分布式设计的实现

### 1.2文档型数据库
mongo leveldb  couchdb
索引实现方式

### 1.3key-value 数据库
redis

### 1.4paxos/bft  zookeeper/etcd


### 1.5fluxdb 时序数据库


### 1.5不同类型数据库之间比较
每种分布式数据库的应用场景




性能
性能三范式所带来的性能损失也是一个问题。为了满足一个查询，多个表的数据都要参与 Join，每一个表都对应着磁盘的一次读取。这和数据放在一个地方，一次读完，当然完全不同。更简单的数据访问模式也让开发者更容易理解数据库的性能表现，尤其是当涉及到索引时。例如，关系型数据库中一个查询太慢了，它 Join 了 6 张表，到底我应该给哪个表的哪一列加什么样的索引呢？
灵活
灵活关系型数据库最常见的运维问题是给已有数据加一个新的可选的属性，从数据表到应用数据层都要改。尽管有些工具可以把它自动化，这仍然是一个复杂的工作，尤其是更新产品线上数据库的时候。MongoDB 没有 Schema（模式、数据模型），就不需要改动数据库，只需要在应用层做必要的改动。
自定义属性也是一个问题，电子商务网站的产品除了价格，ID等，每类产品有许多自定义属性，比如 LCD 和 LED 显示器的产品特性就不一样。数据这种特性被称为「多态」（polymorphism）。关系型数据库里，产品这个表应该怎么设计？最简单的方案，是把每个可能的属性都变成单独一列，当然这个方案不能扩展。更极端一点，一个通讯录允许用户随意添加新的联系方式，你有 Facebook，他有 Twitter。一种方案是在程序里把所有自定义属性序列化，比如用 JSON 放到一列里。另一种方案，叫做 Entity-attribute-value Model，把自定义属性和他们的数据类型，进一步抽象，用关系表来表现。在我看来，这两种方案都是把数据库应该做的工作丢给程序员。这时，相比这些复杂方案，MongoDB 没有 Schema 的优点就显现出来了。

//todo mongo支持地理位置查询？ 啥意思


可扩展性
数据一台机器放不下了，就需要 sharding（分片）把它放到好几台机器上去。分片是 MongoDB 多年以来的原生功能，与 MongoDB 其他功能高效整合。例如，分片集群中一个复杂的聚合查询会自动地根据 Shard Key（片键）分配到多个结点上运行，尽可能将计算任务下推到数据结点上，最后在一个结点上聚合所有结点的结果。分片还可以在各个结点间自动迁移数据，均衡其数据量。为了升级数据库容量，相较于关系型数据库分库分表需要同时改动应用和数据库，分片的运维也简单很多，能够做到对应用透明。

============
你必须意识到传统有关系型数据库与NoSQL系统在数据结构上的本质区别。传统关系型数据库通常是基于行的表格型存储，而NoSQL系统包括了列式存储（Cassandra）、key/value存储（Memcached）、文档型存储（CouchDB）以及图结构存储（Neo4j）

在架构上，你必须搞清楚，NoSQL系统是被设计用于成百上千台机器的集群中的，而非共享型数据库系统的架构。
=================
mongo
实用性，面向文档的数据库，不是关系型数据库，直接存取bson，mongodb更加灵活，不需要定义关系型数据库的“表”的概念，设计数据库变得非常方便，可以大大提升开发速度







## 2.快速入门

### 2.1单机快速安装与简单操作 
安装后插入基本数据 进行增删改查的演练  用docker 

### 2.2集群快速安装与简单操作
添加百万以上数据，用docker搭建集群，curd进行效率比较与分析

### 2.3不同数据库对数据进行优化的方式


## 3. 相关参考



## 4. 数据库具体高性能实现方式
mysql 索引  索引底层的介绍 

mongo 索引  mongo索引的介绍


## 5. 实践应用中主流的分布式数据库



==========================

## 1.数据库 与 数据仓库 本质区别是什么   https://www.zhihu.com/question/20623931

数据仓库增加冗余字段，优化读操作，减弱写操作，在数据量大的时候方便做数据分析
数据库通常更关注业务交易处理（OLTP），而数据仓库更关注数据分析层面（OLAP）
基本上大家都认同数据库用于交易（Transaction），数据仓库用于分析（Analytics）的说法。
通过ETL（Extract-Transform-Load），对OLTP的数据做操作修改进OLAP中


example：
通常的软件架构简化一下就是，用户通过API和数据库交互。
会有四个问题：
数据分析通常涉及大量数据查询，可能会占用太多CPU从而影响软件的基本功能。
数据库的表单结构通常比较复杂，需要数据分析人员对DB结构有深入的了解。
数据库在进行大量数据查询的时候效率较低。
开放数据库访问权限（即便只是读权限），尤其是给外组人员，会有安全隐患。
那么
每隔一段时间把数据库里面的所有数据denormalize到数据仓库里面，在数据仓库里面进行数据分析。

// olap oltp  比较
https://blog.csdn.net/coslay/article/details/46402285

oltp online transaction processing 联机事务处理

OLTP，也叫联机事务处理（Online Transaction Processing），表示事务性非常高的系统，一般都是高可用的在线系统，以小的事务以及小的查询为主，评估其系统的时候，一般看其每秒执行的Transaction以及Execute SQL的数量。在这样的系统中，单个数据库每秒处理的Transaction往往超过几百个，或者是几千个，Select 语句的执行量每秒几千甚至几万个。典型的OLTP系统有电子商务系统、银行、证券等，如美国eBay的业务数据库，就是很典型的OLTP数据库。

OLTP系统最容易出现瓶颈的地方就是CPU与磁盘子系统。

（1）CPU出现瓶颈常表现在逻辑读总量与计算性函数或者是过程上，逻辑读总量等于单个语句的逻辑读乘以执行次数，如果单个语句执行速度虽然很快，但是执行次数非常多，那么，也可能会导致很大的逻辑读总量。设计的方法与优化的方法就是减少单个语句的逻辑读，或者是减少它们的执行次数。另外，一些计算型的函数，如自定义函数、decode等的频繁使用，也会消耗大量的CPU时间，造成系统的负载升高，正确的设计方法或者是优化方法，需要尽量避免计算过程，如保存计算结果到统计表就是一个好的方法。

（2）磁盘子系统在OLTP环境中，它的承载能力一般取决于它的IOPS处理能力. 因为在OLTP环境中，磁盘物理读一般都是db file sequential read，也就是单块读，但是这个读的次数非常频繁。如果频繁到磁盘子系统都不能承载其IOPS的时候，就会出现大的性能问题。（IOPS：Input/Output Operations Per Second）

OLTP比较常用的设计与优化方式为Cache技术与B-tree索引技术，Cache决定了很多语句不需要从磁盘子系统获得数据，所以，Web cache与Oracle data buffer对OLTP系统是很重要的。另外，在索引使用方面，语句越简单越好，这样执行计划也稳定，而且一定要使用绑定变量，减少语句解析，尽量减少表关联，尽量减少分布式事务，基本不使用分区技术、MV技术、并行技术及位图索引。因为并发量很高，批量更新时要分批快速提交，以避免阻塞的发生。


OLAP，也叫联机分析处理（Online Analytical Processing）系统，有的时候也叫DSS决策支持系统，就是我们说的数据仓库。在这样的系统中，语句的执行量不是考核标准，因为一条语句的执行时间可能会非常长，读取的数据也非常多。所以，在这样的系统中，考核的标准往往是磁盘子系统的吞吐量（带宽），如能达到多少MB/s的流量。


